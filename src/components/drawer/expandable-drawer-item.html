<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../../../bower_components/paper-styles/shadow.html">
<link rel="import" href="../../shared-styles.html">

<dom-module id="expandable-drawer-item">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                white-space: nowrap;
                overflow: hidden;
                cursor: pointer;
            }

            paper-icon-item {
                display: block;
                padding: 0;
            }

            .icon {
                display: inline-block;
                vertical-align: middle;
                width: 24px;
                height: 24px;
                margin: 12px;
            }

            .text {
                display: inline-block;
                vertical-align: middle;
                font-size: 16px;
                line-height: 48px;
            }

            #item-content {
                opacity: 1;
                transition: opacity 0.3s ease;
            }

            :host([minimized]) #item-content {
                opacity: 0;
            }

            #persist {
                display: block;
                width: 100%;
                height: 48px;
            }

            #expand-icon {
                float: right;
                transition: transform 0.3s;
            }

            :host([expanded]) #expand-icon {
                transform: rotate(180deg);
            }

            #expandable {
                max-height: 0;
                opacity: 0;
                overflow: hidden;
                transition: max-height 0.3s, opacity 0.3s;
            }

            :host([expanded]) #expandable {
                opacity: 1;
                max-height: 9999px;
            }
        </style>

        <paper-icon-item id="persist" on-click="toggleExpand">
            <div id="icon" class="icon">
                <slot name="icon"></slot>
            </div>
            <div id="item-content" class="text">
                <slot name="item"></slot>
            </div>
            <div id="expand-icon" class="icon">
                <slot name="expand-icon"></slot>
            </div>
        </paper-icon-item>

        <div id="expandable">
            <slot name="expandable"></slot>
        </div>


    </template>

    <script>
        class ExpandableDrawerItem extends Polymer.Element {
            static get is() {
                return 'expandable-drawer-item';
            }

            static get properties() {
                return {
                    minimized: {
                        type: Boolean,
                        value: false,
                        reflectToAttribute: true,
                        observer: '_minimizationChanged'
                    },
                    expanded: {
                        type: Boolean,
                        value: false,
                        reflectToAttribute: true
                    }
                };
            }

            static get observers() {
                return [
                    '_minimizationChanged(minimized)'
                ];
            }

            _minimizationChanged(minimized) {
                if (minimized) {
                    this.expanded = false;
                }
            }

            toggleExpand() {
                this.expanded = !this.expanded;
                if (this.expanded) {
                    this._requireDrawerExpansion();
                }
            }

            _requireDrawerExpansion() {
                this.dispatchEvent(new CustomEvent('require-drawer-expansion', {
                    bubbles: true,
                    composed: true
                }));
            }
        }

        window.customElements.define(ExpandableDrawerItem.is, ExpandableDrawerItem);
    </script>
</dom-module>